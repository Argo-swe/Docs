\subsubsubsection{Adapters - Incoming}

\paragraph{SchemaValidatorFactory} \label{SchemaValidatorFactory}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{assets/Backend/schema_validator_factory.png}
    \caption{Diagramma della classe SchemaValidatorFactory}
  \end{figure}
\begin{itemize}
    \item \textbf{Descrizione}: SchemaValidatorFactory si occupa della creazione di istanze di validatori di schema, come JsonSchemaValidatorAdapter, basandosi sulla configurazione fornita;
    \item \textbf{Metodi}:
    \begin{itemize}
        \item \texttt{+ \underline{create(config: dict)} -> SchemaValidatorUseCase}: restituisce un'istanza del validatore in base al valore associato alla chiave "validation_file_type".
    \end{itemize}
    \item \textbf{Dipendenze}:
    \begin{itemize}
        \item JsonSchemaValidatorAdapter.
    \end{itemize}
\end{itemize}  

\paragraph{JsonSchemaValidatorAdapter} \label{JsonSchemaValidatorAdapter}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{assets/Backend/json_schema_validator_adapter.png}
    \caption{Diagramma della classe JsonSchemaValidatorAdapter}
  \end{figure}
\begin{itemize}
    \item \textbf{Descrizione}: JsonSchemaValidatorAdapter implementa il caso d'uso di validazione dello schema dei dizionari in formato \glossario{JSON};
    \item \textbf{Interfaccia implementata}: \hyperref[SchemaValidatorUseCase]{SchemaValidatorUseCase};
    \item \textbf{Attributi}:
    \begin{itemize}
        \item \texttt{dictionary\_schema\_file\_path}: percorso del file \glossario{JSON} che contiene lo schema dei dizionari dati.
    \end{itemize}
    \item \textbf{Metodi}:
    \begin{itemize}
        \item \texttt{JsonSchemaValidatorAdapter()}: costruttore della classe;
        \item \texttt{+ validate(dictionary: dict) -> bool}: valida il dizionario dati rispetto a uno schema predefinito.
    \end{itemize}
    \item \textbf{Dipendenze}:
    \begin{itemize}
        \item SchemaValidatorUseCase;
        \item Utils.
    \end{itemize}
\end{itemize} 

\subsubsubsection{Outcoming - Adapters}

\paragraph{DbManagerFactory} \label{DbManagerFactory}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{assets/Backend/db_manager_factory.png}
    \caption{Diagramma della classe DbManagerFactory}
  \end{figure}
\begin{itemize}
    \item \textbf{Descrizione}: DbManagerFactory si occupa della creazione di istanze di gestori di \glossario{database} specifici, come SqlAlchemyDbManagerFactory, basandosi sulla configurazione fornita;
    \item \textbf{Metodi}:
    \begin{itemize}
        \item \texttt{+ create(config: dict) -> DbManagerAbstractFactory}: restituisce un'istanza del gestore di database in base al valore associato alla chiave "db_manager".
    \end{itemize}
    \item \textbf{Dipendenze}:
    \begin{itemize}
        \item DbManagerAbstractFactory.
    \end{itemize}
\end{itemize}

\paragraph{SqlAlchemyDbManagerFactory} \label{SqlAlchemyDbManagerFactory}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{assets/Backend/sql_alchemy_db_manager_factory.png}
    \caption{Diagramma della classe SqlAlchemyDbManagerFactory}
  \end{figure}
\begin{itemize}
    \item \textbf{Descrizione}: SqlAlchemyDbManagerFactory si occupa della creazione di istanze di classi per la gestione degli utenti e dei dizionari utilizzando \glossario{SQLAlchemy};
    \item \textbf{Interfaccia implementata}: \hyperref[DbManagerAbstractFactory]{DbManagerAbstractFactory};
    \item \textbf{Metodi}:
    \begin{itemize}
        \item \texttt{+ create\_authentication\_repository() -> AuthenticationRepository}: restituisce un'istanza della classe SqlAlchemyAuthenticationRepositoryAdapter;
        \item \texttt{+ create\_dictionary\_repository() -> DictionaryRepository}: restituisce un'istanza della classe SqlAlchemyDictionaryRepositoryAdapter.
    \end{itemize}
    \item \textbf{Dipendenze}:
    \begin{itemize}
        \item AuthenticationRepository;
        \item DictionaryRepository.
    \end{itemize}
\end{itemize}

\paragraph{SqlAlchemyAuthenticationRepositoryAdapter} \label{SqlAlchemyAuthenticationRepositoryAdapter}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{assets/Backend/sql_alchemy_authentication_repository_adapter.png}
    \caption{Diagramma della classe SqlAlchemyAuthenticationRepositoryAdapter}
  \end{figure}
\begin{itemize}
    \item \textbf{Descrizione}: SqlAlchemyAuthenticationRepositoryAdapter interagisce con un database utilizzando \glossario{SQLAlchemy} per la gestione degli utenti;
    \item \textbf{Interfaccia implementata}: \hyperref[AuthenticationRepository]{AuthenticationRepository};
    \item \textbf{Attributi}:
    \begin{itemize}
        \item \texttt{session}: sessione di connessione al database.
    \end{itemize}
    \item \textbf{Metodi}:
    \begin{itemize}
        \item \texttt{SqlAlchemyAuthenticationRepositoryAdapter(session: SessionLocal)}: costruttore della classe;
        \item \texttt{+ get\_user\_by\_username(username: string) -> AdminDto}: recupera un admin dal database tramite il suo username.
    \end{itemize}
\end{itemize} 

\paragraph{SqlAlchemyDictionaryRepositoryAdapter} \label{SqlAlchemyDictionaryRepositoryAdapter}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{assets/Backend/sql_alchemy_dictionary_repository_adapter.png}
    \caption{Diagramma della classe SqlAlchemyDictionaryRepositoryAdapter}
  \end{figure}
\begin{itemize}
    \item \textbf{Descrizione}: SqlAlchemyDictionaryRepositoryAdapter interagisce con un database utilizzando \glossario{SQLAlchemy} per la gestione dei dizionari;
    \item \textbf{Interfaccia implementata}: \hyperref[DictionaryRepository]{DictionaryRepository};
    \item \textbf{Attributi}:
    \begin{itemize}
        \item \texttt{session}: sessione di connessione al database.
    \end{itemize}
    \item \textbf{Metodi:}
    \begin{itemize}
        \item \texttt{SqlAlchemyDictionaryRepositoryAdapter(session: SessionLocal)}: costruttore della classe;
        \item \texttt{+ get\_all\_dictionaries() -> List[DictionaryDto]}: recupera tutti i dizionari dal database;
        \item \texttt{+ get\_dictionary\_by\_id(id: integer) -> DictionaryDto}: recupera un dizionario tramite il suo ID;
        \item \texttt{+ get\_dictionary\_by\_name(name: string) -> DictionaryDto}: recupera un dizionario tramite il suo nome;
        \item \texttt{+ create\_dictionary(name: string, description: string) -> DictionaryDto}: crea un nuovo dizionario nel database;
        \item \texttt{+ update\_dictionary(id: integer, name: string, description: string) -> DictionaryDto}: aggiorna i dati di un dizionario nel database;
        \item \texttt{+ delete\_dictionary(id: integer)}: elimina un dizionario dal database.
    \end{itemize}
\end{itemize} 

\paragraph{EmbeddingsManagerFactory} \label{EmbeddingsManagerFactory}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{assets/Backend/embeddings_manager_factory.png}
    \caption{Diagramma della classe EmbeddingsManagerFactory}
  \end{figure}
\begin{itemize}
    \item \textbf{Descrizione}: EmbeddingsManagerFactory si occupa della creazione di istanze di gestori di \glossario{embeddings}, come TxtaiEmbeddingsManagerFactory, basandosi sulla configurazione fornita;
    \item \textbf{Metodi}:
    \begin{itemize}
        \item \texttt{+ \underline{create(config: dict)} -> EmbeddingsAbstractFactory}: restituisce un'istanza del gestore di embeddings in base al valore associato alla chiave "embeddings_type".
    \end{itemize}
    \item \textbf{Dipendenze}:
    \begin{itemize}
        \item EmbeddingsAbstractFactory.
    \end{itemize}
\end{itemize} 

\paragraph{TxtaiEmbeddingsManagerFactory} \label{TxtaiEmbeddingsManagerFactory}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{assets/Backend/txtai_embeddings_manager_factory.png}
    \caption{Diagramma della classe TxtaiEmbeddingsManagerFactory}
  \end{figure}
\begin{itemize}
    \item \textbf{Descrizione}: TxtaiEmbeddingsManagerFactory si occupa della creazione di istanze di gestori degli \glossario{indici} e dei \glossario{prompt} utilizzando \glossario{txtai};
    \item \textbf{Interfaccia implementata}: \hyperref[EmbeddingsAbstractFactory]{EmbeddingsAbstractFactory};
    \item \textbf{Attributi}:
    \begin{itemize}
        \item \texttt{config}: dizionario di configurazione del sistema.
    \end{itemize}
    \item \textbf{Metodi}:
    \begin{itemize}
        \item \texttt{TxtaiEmbeddingsManagerFactory(config: dict)}: costruttore della classe;
        \item \texttt{create\_index\_manager(file\_repository: FileRepository) -> IndexManagerPort}: restituisce un'istanza della classe TxtaiIndexManagerAdapter, impostando parametri specifici per txtai;
        \item \texttt{create\_prompt\_manager\_with\_dependencies(index\_manager: IndexManagerPort, file\_repository: FileRepository) -> TxtaiPromptManagerAdapter}: restituisce un'istanza della classe TxtaiPromptManagerAdapter;
        \item \texttt{create\_prompt\_manager(file\_repository: FileRepository): IndexManagerPort}: crea un gestore degli indici e restituisce un'istanza della classe \texttt{TxtaiPromptManagerAdapter}.
    \end{itemize}
    \item \textbf{Dipendenze}:
    \begin{itemize}
        \item FileRepository;
        \item IndexManagerPort;
        \item PromptManagerPort.
    \end{itemize}
\end{itemize} 

\paragraph{TxtaiIndexManagerAdapter} \label{TxtaiIndexManagerAdapter}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{assets/Backend/txtai_index_manager_adapter.png}
    \caption{Diagramma della classe TxtaiIndexManagerAdapter}
  \end{figure}
\begin{itemize}
    \item \textbf{Descrizione}: TxtaiIndexManagerAdapter gestisce le operazioni \glossario{CRUD} sugli indici utilizzando \glossario{txtai};
    \item \textbf{Interfaccia implementata}: \hyperref[IndexManagerPort]{IndexManagerPort};
    \item \textbf{Attributi}:
    \begin{itemize}
        \item \texttt{file\_repository}: istanza del gestore dei file;
        \item \texttt{indexes\_out\_file\_base\_path}: percorso della cartella contenente gli indici;
        \item \texttt{embeddings}: istanza di Embeddings utilizzata per la gestione degli embeddings.
    \end{itemize}
    \item \textbf{Metodi}:
    \begin{itemize}
        \item \texttt{TxtaiIndexManagerAdapter(file\_repository: FileRepository, table\_path: string, column\_path: string)}: costruttore della classe;
        \item \texttt{+ get_embeddings}: recupera l'istanza di Embeddings;
        \item \texttt{+ create\_or\_load\_index(dictionary_id: integer) -> bool}: crea o ripristina l'indice per un dizionario;
        \item \texttt{+ create\_index(dictionary_id: integer, save_index: bool)}: crea un nuovo indice per un dizionario;
        \item \texttt{+ save\_index(dictionary_id: integer)}: salva l'indice associato a un dizionario;
        \item \texttt{+ load\_index(dictionary_id: integer)}: ripristina l'indice associato a un dizionario;
        \item \texttt{+ delete\_index(dictionary_id: integer)}: elimina l'indice associato a un dizionario;
        \item \texttt{- index\_file\_path(dictionary_id: integer) -> str}: restituisce il percorso completo dell'indice associato a un dizionario.
    \end{itemize}
    \item \textbf{Dipendenze}:
    \begin{itemize}
        \item FileRepository.
    \end{itemize}
\end{itemize} 

\paragraph{TxtaiPromptManagerAdapter} \label{TxtaiPromptManagerAdapter}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{assets/Backend/txtai_prompt_manager_adapter.png}
    \caption{Diagramma della classe TxtaiPromptManagerAdapter}
  \end{figure}
\begin{itemize}
    \item \textbf{Descrizione}: TxtaiPromptManagerAdapter gestisce la generazione di \glossario{prompt} utilizzando \glossario{txtai};
    \item \textbf{Interfaccia implementata}: \hyperref[PromptManagerPort]{PromptManagerPort};
    \item \textbf{Attributi}:
    \begin{itemize}
        \item \texttt{index\_manager}: istanza del gestore degli \glossario{indici};
        \item \texttt{file\_repository}: istanza del gestore dei file;
        \item \texttt{debug\_manager}: istanza della classe utilizzata per gestire le operazioni di \glossario{debug}.
    \end{itemize}
    \item \textbf{Metodi}:
    \begin{itemize}
        \item \texttt{+ prompt\_generator(dictionary\_id: integer, user\_request: string, lang: string, dbms: string, activate\_log: bool) -> tuple[str, str]}: carica l'indice associato a un dizionario e genera un prompt basato sulla richiesta dell'utente;
        \item \texttt{+ get\_index\_manager() -> IndexManagerPort}: restituisce l'istanza del gestore degli indici;
        \item \texttt{- create\_debug\_manager() -> DebugManagerPort}: crea un'istanza del gestore di debug;
        \item \texttt{- get\_tuples(user\_request: string, activate\_log: bool) -> tuple[list, str]}: restituisce i risultati della ricerca semantica effettuata con txtai;
        \item \texttt{- get\_relevant\_tuples(tuples: list, activate\_log: bool) -> tuple[list, str]}: restituisce le tabelle considerate rilevanti dall'algoritmo di ricerca implementato dal team.
    \end{itemize}
    \item \textbf{Dipendenze}:
    \begin{itemize}
        \item IndexManagerPort;
        \item FileRepository;
        \item DebugManagerPort.
    \end{itemize}
\end{itemize} 

\paragraph{TxtaiDebugManagerAdapter} \label{TxtaiDebugManagerAdapter}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{assets/Backend/txtai_debug_manager_adapter.png}
    \caption{Diagramma della classe TxtaiDebugManagerAdapter}
  \end{figure}
\begin{itemize}
    \item \textbf{Descrizione}: TxtaiDebugManagerAdapter fornisce funzionalità di \glossario{logging} per il processo di ricerca semantica;
    \item \textbf{Interfaccia implementata}: \hyperref[DebugManagerPort]{DebugManagerPort};
    \item \textbf{Attributi}:
    \begin{itemize}
        \item \texttt{index\_manager}: istanza del gestore degli \glossario{indici}.
    \end{itemize}
    \item \textbf{Metodi:}
    \begin{itemize}
        \item \texttt{TxtaiDebugManagerAdapter(index\_manager: IndexManagerPort)}: costruttore della classe;
        \item \texttt{+ semantic\_search\_log(user\_request: string, tuples: list) -> List[str]}: restituisce il \glossario{log} della ricerca semantica effettuata con \glossario{txtai};
        \item \texttt{+ semantic\_search\_log\_custom\_algorithm(relevant\_tuples: list, tuples: list) -> List[str]}: restituisce il log dell'algoritmo di ricerca implementato dal team.
        \item \texttt{- get\_debug\_header(level: string, system: string) -> string}: costruisce l'intestazione del log.
    \end{itemize}
    \item \textbf{Dipendenze}:
    \begin{itemize}
        \item IndexManagerPort.
    \end{itemize}
\end{itemize} 

\paragraph{FileFactory} \label{FileFactory}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{assets/Backend/file_factory.png}
    \caption{Diagramma della classe FileFactory}
  \end{figure}
\begin{itemize}
    \item \textbf{Descrizione}: FileFactory si occupa della creazione di istanze di gestori di file, come JsonFileAdapter, basandosi sulla configurazione fornita;
    \item \textbf{Metodi}:
    \begin{itemize}
        \item \texttt{+ \underline{create(config: dict)} -> FileRepository}: restituisce un'istanza del gestore di file in base al valore associato alla chiave "file_type".
    \end{itemize}
    \item \textbf{Dipendenze}:
    \begin{itemize}
        \item FileRepository.
    \end{itemize}
\end{itemize} 

\paragraph{JsonFileAdapter} \label{JsonFileAdapter}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{assets/Backend/json_file_adapter.png}
    \caption{Diagramma della classe JsonFileAdapter}
  \end{figure}
\begin{itemize}
    \item \textbf{Descrizione}: JsonFileAdapter gestisce le operazioni \glossario{CRUD} sui file associati ai dizionari dati;
    \item \textbf{Interfaccia implementata}: \hyperref[FileRepository]{FileRepository};
    \item \textbf{Attributi}:
    \begin{itemize}
        \item \texttt{file\_path: string}: percorso della cartella contenente i file dei dizionari dati;
    \end{itemize}
    \item \textbf{Metodi}:
    \begin{itemize}
        \item \texttt{JsonFileAdapter(file\_path: string)}: costruttore della classe;
        \item \texttt{+ save(id: integer, file: string)}: salva il file;
        \item \texttt{+ load(id: integer) -> string}: restituisce il percorso del file;
        \item \texttt{+ delete(id: integer)}: elimina il file;
        \item \texttt{+ get\_preview(id: integer) -> DictionaryPreviewDto}: recupera un'anteprima del file;
        \item \texttt{+ extract\_index\_metadata(id: integer) -> list}: estrae i metadati per l'\glossario{indicizzazione};
        \item \texttt{+ extract\_schema\_metadata(id: integer, tuples: list): string}: estrae i metadati in forma di \glossario{prompt};
        \item \texttt{- get\_json\_schema(id: integer) -> dict}: restituisce lo schema del file JSON;
        \item \texttt{- generate\_schema\_file\_name(id: integer): string}: genera il percorso completo del file.
    \end{itemize}
    \item \textbf{Dipendenze}:
    \begin{itemize}
        \item Utils.
    \end{itemize}
\end{itemize} 